# 3.5 변수 범위의 이해

## - 산술 오버플로

종종 수학적/논리적으로 완전히 정당한 알고리즘도 프로그램으로 구현하면 예상과 다르게 동작하는 경우가 있다. 이 문제를 일으키는 흔한 원인이 산술 오버플로이다. 

산술 오버플로를 체크하지 못하는 이유에는 크게 두 가지가 있다.

1. 대부분의 언어는 연산이 일어날 때마다 오버플로를 확인하지 않는다.
2. 프로그램을 작성할 때 논리에만 너무 집중하게 되면 산술 오버플로가 등장할 수 있다는 사실을 잊기 쉽다.



산술 오버플로가 일어날 수 있는 대표적인 상황

1. 너무 큰 결과.
2. 너무 큰 중간 값.
3. 너무 큰 '무한대' 값.



## - 너무 큰 결과

당연히 연산 결과가 우리가 보통 사용하는 32비트 자료형의 범위를 넘어가면 산술 오버플로가 발생한다. 따라서 큰 정수를 다룰 때는 항상 변수의 형태에 주의해야 한다.



## - 너무 큰 중간 값

연산의 결과 값의 범위는 작지만 연산 과정 중간에 큰 범위의 중간 값이 나올 수 있다. 이런 상황을 신경 쓰지 않는다면 산술 오버플로가 발생할 수 있다. 



## - 너무 큰 '무한대' 값

종종 문제에서 '무한대'에 대응되는 큰 값을 사용하는 것이 편리할 때가 있다. 하지만 이때 '무한대' 값을 너무 크게 설정하면 산술 오버플로가 일어나 내가 원하지 않는 결과 값이 나올 수 있다. 

따라서 '무한대' 값을. 설정할 때는 무한대 값들끼리 서로 곱해지거나, 더해지는 경우는 없는지 확인하고, 너무 크지 않는 값으로 '무한대'를 설정해야 한다.



## - 오버플로 피해가기

오버플로의 발생을 확인했을 때 크게 두 가지 방법으로 해당 문제를 해결할 수 있다.

1. 더 큰 자료형 쓰기.
2. 오버플로가 나지 않도록 연산의 순서를 바꾸기.



## - 자료형의 프로모션

만약 피연산자의 자료형이 다르거나 자료형의 범위가 너무 작은 경우 컴파일러는 자료형을 변환해서 계산한다. 이를 프로모션이라고 한다. 이는 가끔 알기 어려운 버그를 만드는 원인이 되기도 한다. 따라서 언어마다 프로모션 과정을 알아두면 좋다.

다음은 c++의 프로모션 규칙이다.

1. 한쪽은 정수형이고 한쪽은 실수형일 경우 : 정수형이 실수형으로 변환.
2. 양쪽 다 정수형이거나 양쪽 다 실수형일 경우 : 보다 넓은 범위를 갖는 자료형으로 변환.
3. 양쪽 다 int 형보다 작은 정수형인 경우 : 양쪽 다 int형으로 변환.
4. 부호 없는 정수형과 부호 있는 정수형이 섞여 있을 경우 : 부호 없는 정수형으로 변환.

